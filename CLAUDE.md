# 🍱 献立作成アプリ MVP要件定義

## 📋 基本仕様

### アプリ概要

毎日の献立作成を楽にする献立提案アプリ。冷蔵庫にある食材を入力すると、AI が1食分の献立（主菜・副菜・汁物）を提案する。

### ターゲットユーザー

- 毎日の献立に悩む人
- 冷蔵庫の食材を有効活用したい人

---

## ✅ MVP機能要件

### 1. 献立生成機能

- **入力項目**
  - 食材：冷蔵庫にある食材をテキスト入力
  - ジャンル：和食・洋食・中華から選択
  - 調理時間：指定可能（15分、30分、1時間など）

- **出力内容**
  - 主菜・副菜・汁物の3品構成
  - 各料理の材料リスト（分量付き）
  - 調理手順
  - 調理時間

### 2. 再生成機能

- 提案された献立が気に入らない場合
- 「他の献立を提案」ボタンで再生成

### 3. 表示機能

- 主菜・副菜・汁物を同時表示
- 各料理の詳細（材料・手順）はアコーディオン展開

### 4. 買い物リスト機能

- 献立から足りない食材を洗い出し
- 既に持っている食材の選択機能
- カテゴリ別の買い物リスト表示
- リストのコピー機能

---

## 🚫 MVP対象外

### 今回含まない機能

- ユーザー登録・認証機能
- 献立の保存機能
- 過去の履歴表示
- 料理画像の表示

### 将来拡張予定（フェーズ2以降）

#### フェーズ2: 栄養価・バックエンド対応

- **栄養価表示機能**
  - カロリー（kcal）
  - タンパク質、脂質、炭水化物（PFC）
  - ビタミン・ミネラル
  - 塩分相当量
  - 食物繊維、糖質
  - 料理ごと（主菜・副菜・汁物）の栄養価表示
- **バックエンド・DB基盤**
  - ユーザー認証・登録機能
  - 献立履歴の保存
  - 食材マスタ＋栄養価DB

#### フェーズ3: 追加機能

- お気に入り献立保存
- 料理画像表示
- 買い物リストの永続化・保存
- 複数献立の統合買い物リスト
- 価格情報・店舗情報連携

---

## 🛠️ 技術要件

### フロントエンド

- Next.js (App Router)
- Tailwind CSS
- TypeScript

### バックエンド・AI

- OpenAI API (GPT-4o)
- 構造化レスポンス（JSON形式）

### データ管理

- 認証なしのため、データベース不要
- セッション内でのデータ管理のみ

### フェーズ2以降の技術スタック

#### バックエンド

- Hono（軽量Webフレームワーク）
- Prisma（ORM）
- PostgreSQL（DB）
- NextAuth.js（認証）

#### インフラ

- Supabase（PostgreSQL + 認証 + Storage）

#### 栄養価機能

- 日本食品標準成分表2020年版（八訂）ベース
- 食材マスタDB（栄養価情報付き）
- AIが食材IDと分量を出力して自動栄養価計算

---

## 🎯 成功指標

### 機能面

- 食材を入力してから献立が表示されるまで5秒以内
- 適切な献立が生成される（主菜・副菜・汁物のバランス）
- 再生成で異なる献立が提案される

### ユーザー体験

- 直感的な操作で献立生成が可能
- シンプルで使いやすいUI
- モバイル対応

---

## 📝 画面設計

### メイン画面

1. **入力エリア**
   - 食材入力欄
   - ジャンル選択
   - 調理時間選択
   - 「献立を作成」ボタン

2. **結果表示エリア**
   - 主菜・副菜・汁物の料理名
   - 材料・手順のアコーディオン
   - 「他の献立を提案」ボタン

---

## ディレクトリ構成

```
src/
├── app/                # Next.js App Router 用
│   └── api/            # API Routes
│
├── components/         # 再利用可能な UI コンポーネント
│   └── ui/             # Button, Input など汎用パーツ
│
├── features/           # ドメイン単位の機能
│   └── menu/
│       ├── components/ # MenuForm, MenuDisplay など機能専用UI
│       ├── hooks/      # useGenerateMenu など
│       ├── lib/        # AI呼び出し、ロジック関数など
│       └── types.ts    # Menu, Dish などの型
│
├── libs/               # OpenAI など外部クライアント
├── utils/              # 共通ユーティリティ関数
└── styles/             # グローバルCSS
```

---

## 🛠️ コーディングルール

### 1. 責務の分離

- **UI とロジックを分ける**
  - 表示専用コンポーネント → `components/`・`features/**/components/`
  - ビジネスロジック・副作用 → `features/**/hooks/` と `features/**/lib/`
- **ドメインごとに `features/` を切る**
  - 例：`features/menu`。機能追加時も同じパターンで拡張。
- **外部依存は `libs/` に集約**
  - `openaiClient.ts` など。テスト時にモックしやすくする。

### 2. 型安全

- **`any` 使用禁止**（`unknown` で受けて適切に狭める）。
- **OpenAI からのレスポンスは JSON で受け、専用パーサ関数で型を保証**

### 3. テスト

- ロジック・フック・ユーティリティは必要に応じてテスト追加。

---

---

## 📊 フェーズ2: 栄養価機能詳細仕様

### 栄養価表示項目

- **基本栄養素**
  - カロリー（kcal）
  - タンパク質（g）
  - 脂質（g）
  - 炭水化物（g）
  - 食物繊維（g）
  - 糖質（g）
  - 塩分相当量（g）

- **ビタミン・ミネラル**（主要なもの）
  - ビタミンA（μg）
  - ビタミンC（mg）
  - カルシウム（mg）
  - 鉄（mg）

### 表示方法

- 献立全体の栄養価サマリー
- 料理別（主菜・副菜・汁物）の栄養価詳細
- 1人前あたりの計算
- 栄養バランスの視覚化（円グラフ・棒グラフ）

### 食材マスタDB設計

```sql
-- 食材マスタ
CREATE TABLE ingredients (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  category VARCHAR(50),
  unit VARCHAR(20), -- g, ml, 個など
  -- 100gあたりの栄養価
  calories DECIMAL(6,2),
  protein DECIMAL(6,2),
  fat DECIMAL(6,2),
  carbohydrate DECIMAL(6,2),
  fiber DECIMAL(6,2),
  sodium DECIMAL(6,2)
);
```

### 実装優先度

1. **食材マスタDB構築**（日本食品標準成分表ベース）
2. **栄養価計算エンジン**
3. **UI表示機能**
4. **献立履歴保存**
5. **ユーザー認証**

---

_作成日: 2025-08-29_
_更新日: 2025-08-31_
